{% load static %}
<!DOCTYPE html>
<html lang="en">

<!--================================================================================
	Item Name: Materialize - Material Design Admin Template
	Version: 3.1
	Author: GeeksLabs
	Author URL: http://www.themeforest.net/user/geekslabs
================================================================================ -->

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="msapplication-tap-highlight" content="no">
    <meta name="description" content="teranga-food est un service de commande en ligne dans des restaurants,fast-food et pizzarias">
    <meta name="keywords" content="teranga-food,fast-food,pizzaria,restaurant,dakar food,livraison à domicile,pizza,hamberger,hot-dog">
    <title>{% block titre_page %}Teranga-Food{% endblock %}</title>

    <!-- Favicons-->
    <link rel="icon" href="{% static 'teranga_food_logo_192.png' %}" sizes="42x42">
     <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <!-- Favicons-->
   <link rel="apple-touch-icon-precomposed" href="{% static 'teranga_food_logo.png' %}">
    <!-- For iPhone -->
    <meta name="msapplication-TileColor" content="#00bcd4">
    <meta name="msapplication-TileImage" content="images/favicon/mstile-144x144.png">
    <!-- For Windows Phone -->


    <!-- CORE CSS-->
    <link href="{% static 'myTemplate/css/materialize.min.css' %}" type="text/css" rel="stylesheet" media="screen,projection">
    <link href="{% static 'font-awesome/css/font-awesome.min.css' %}" type="text/css" rel="stylesheet" media="screen,projection">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">

    <link href="{% static 'myTemplate/css/style.min.css' %}" type="text/css" rel="stylesheet" media="screen,projection">
    <!-- Custome CSS-->
    <!--link href="css/custom/custom.min.css" type="text/css" rel="stylesheet" media="screen,projection"-->


    <!-- INCLUDED PLUGIN CSS ON THIS PAGE -->
    <link href="{% static 'myTemplate/js/plugins/perfect-scrollbar/perfect-scrollbar.css' %}" type="text/css" rel="stylesheet" media="screen,projection">
    <link href="{% static 'myTemplate/js/plugins/jvectormap/jquery-jvectormap.css' %}" type="text/css" rel="stylesheet" media="screen,projection">
    <link href="{% static 'myTemplate/js/plugins/chartist-js/chartist.min.css' %}" type="text/css" rel="stylesheet" media="screen,projection">
    <style>
        #btnUpdateQtePlus,#btnUpdateQteMoins
        {
            cursor: pointer;
        }
    </style>
{% block bloc_css %}

{% endblock %}</head>

<body>
    <!-- Start Page Loading -->
    <div id="loader-wrapper">
        <div id="loader"></div>
        <div class="loader-section section-left"></div>
        <div class="loader-section section-right"></div>
    </div>
    <!-- End Page Loading -->

    <!-- //////////////////////////////////////////////////////////////////////////// -->

    <!-- START HEADER -->
    <header id="header" class="page-topbar">
        <!-- start header nav-->
        <div class="navbar-fixed" >
            <nav class="navbar-color" style="background-color: gold;">
                <div class="nav-wrapper">
                    <ul class="hide-on-small-only">
                      <li class=""><h1 class="logo-wrapper "><a href="{% url 'main_acceuil' %}" class="brand-logo darken-1"><span style="color: green">Te</span><span  style="color: yellow">ran</span><span  style="color: red">ga-</span><span style="color:#ffffb3">Food</span><!--img src="{% static 'myTemplate/images/materialize-logo.png' %}" alt="materialize logo"--></a> </h1></li>
                    </ul>
                    <ul class="hide-on-med-and-up"  >
                      <li class="" style="position: relative;left: 140px;"><h1 class="logo-wrapper" ><a  href="{% url 'main_acceuil' %}" class="brand-logo darken-1"><span style="color: green">Te</span><span  style="color: yellow">ran</span><span  style="color: red">ga-</span><span style="color:#ffffb3">Food</span><!--img src="{% static 'myTemplate/images/materialize-logo.png' %}" alt="materialize logo"--></a> </h1></li>
                    </ul>
                    <div class="header-search-wrapper hide-on-med-and-down">
                        <i class="mdi-action-search"></i>
                        <input type="text" name="Search" class="header-search-input z-depth-2" placeholder="Rechercher un restaurant"/>
                    </div>
                    <ul class="right hide-on-small-only">

                      <li ><a href="javascript:void(0);" class="waves-effect waves-block waves-light toggle-fullscreen"><i class="mdi-action-settings-overscan"></i></a></li>

                        <li >
                            <!--a href="javascript:void(0);" class="waves-effect waves-block waves-light notification-button" data-activates="notifications-dropdown1"-->

                                <!--i class="mdi-social-notifications"><small class="notification-badge">5</small></i-->
                                <ul class="dropdown">
                                    <li class="dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><a href="" >

                                    <!--li class="dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"--><i class="mdi-social-notifications btnNotification" ><small style="position: relative;top: -25px;left: -10px;background-color: red;border-radius: 8px;padding: 2px" class="nbr_notifications" id="" hidden></small></i><!--/li-->
                                    </a> </li>
                                  <!--button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    Dropdown button
                                  </button-->
                                  <div id="" class="dropdown-menu blocNotification" aria-labelledby="dropdownMenuButton" style="margin-top: 65px;">
                                    <!--li style="width: 100%;"><a class="dropdown-item" href="#">Action</a></li>
                                    <li style="width: 100%;"><a class="dropdown-item" href="#">Another action</a></li>
                                    <li ><a style="width: 100%;" class="dropdown-item" href="#">Something else here<br> JHJHJHJHJ ghghghgh</a></li-->
                                  </div>
                                </ul>
                            <!--/a-->
                        </li>

                         <li ><a href="javascript:void(0);"  class="waves-effect waves-block waves-light notification-button btnMyBasket" data-activates=""><i class="mdi-action-shopping-basket"><small class="notification-badge nbr_basket_items" ></small></i></a></li>

                        <li >
                            <!--a href="javascript:void(0);" class="waves-effect waves-block waves-light notification-button" data-activates="notifications-dropdown1"-->

                                <!--i class="mdi-social-notifications"><small class="notification-badge">5</small></i-->
                                <ul class="dropdown">
                                    <li class="dropdown-toggle" type="button" id="dropdownMenuButton1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><a href="" >

                                    <!--li class="dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"--><i class="fa fa-user-circle fa-2x" ></i><!--/li-->

                                    </a> </li>
                                  <!--button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    Dropdown button
                                  </button-->

                                  <div class="dropdown-menu" aria-labelledby="dropdownMenuButton1" style="margin-top: 60px;margin-left: -100px;">

                                      {% if request.user.is_authenticated %}
                                              <li style="width: 100%;">
                                                <a href="{% url 'my_logout' %}" class="myOwnLink"><i class="fa fa-sign-out" style="display: inline-block"></i> Se déconnecter</a>
                                              </li>
                                            <li style="width: 100%;">
                                                <a href="#!"><i class="fa fa-cogs" style="display: inline-block"></i> Paramètre</a>
                                              </li>
                                        {% else %}
                                             <li style="width: 100%;">
                                                <a href="{% url 'login' %}"  class="myOwnLink" style="color: black"><i class="fa fa-sign-in" style="display: inline-block"></i> Se connecter</a>
                                            </li>
                                              <li style="width: 100%;">
                                                <a href="{% url 'inscription' %}"  class="myOwnLink" style="color: black"><i class="fa fa-sign-out" style="display: inline-block"></i>S'inscrire</a>
                                              </li>
                                        {% endif %}

                                  </div>
                                </ul>
                            <!--/a-->
                        </li>

                        <!--li ><a href="javascript:void(0);" class="waves-effect waves-block waves-light notification-button" data-activates="user-dropdown"><i class="fa fa-user-circle fa-2x"></i></a></li-->
                    </ul>
                    <ul class="right hide-on-med-and-up"  style="position: relative;left: 15px;">
                        <li style="position: relative;left: 20px;"><a href="javascript:void(0);" class="waves-effect waves-block waves-light toggle-fullscreen"><i class="mdi-action-settings-overscan"></i></a>
                        </li>
                        <!--li style="position: relative;left: 7px;"><a href="javascript:void(0);" class="waves-effect waves-block waves-light notification-button" data-activates="notifications-dropdown"><i class="mdi-social-notifications"><small class="notification-badge">5</small></i></a></li-->
                        <li >
                            <!--a href="javascript:void(0);" class="waves-effect waves-block waves-light notification-button" data-activates="notifications-dropdown1"-->

                                <!--i class="mdi-social-notifications"><small class="notification-badge">5</small></i-->
                                <ul class="dropdown">
                                    <li class="dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><a href="" >

                                    <!--li class="dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"--><i class="mdi-social-notifications btnNotification" ><small class="notification-badge nbr_notifications" hidden></small></i><!--/li-->
                                    </a> </li>
                                  <!--button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    Dropdown button
                                  </button-->
                                  <div class="dropdown-menu blocNotification" aria-labelledby="dropdownMenuButton" style="margin-top: 60px;margin-left: -70px;">

                                  </div>
                                </ul>
                            <!--/a-->
                        </li>

                         <li style="position: relative;left: -3px;"><a href="javascript:void(0);" id=""  class="waves-effect waves-block waves-light notification-button btnMyBasket" data-activates=""><i class="mdi-action-shopping-basket"><small class="notification-badge nbr_basket_items" id=""></small></i>
                        </a>
                        </li>

                        <!--li><a href="#" data-activates="chat-out" class="waves-effect waves-block waves-light chat-collapse"><i class="mdi-communication-chat"></i></a>
                        </li-->

                    </ul>
                    <!-- translation-button -->

                    <!-- notifications-dropdown -->
                    <ul id="notifications-dropdown" class="dropdown-content">
                      <li>
                        <h5>NOTIFICATIONS <span class="new badge">5</span></h5>
                      </li>
                      <li class="divider"></li>
                      <li>
                        <a href="#!"><i class="mdi-action-add-shopping-cart"></i> A new order has been placed!</a>
                        <time class="media-meta" datetime="2015-06-12T20:50:48+08:00">2 hours ago</time>
                      </li>
                      <li>
                        <a href="#!"><i class="mdi-action-stars"></i> Completed the task</a>
                        <time class="media-meta" datetime="2015-06-12T20:50:48+08:00">3 days ago</time>
                      </li>
                      <li>
                        <a href="#!"><i class="mdi-action-settings"></i> Settings updated</a>
                        <time class="media-meta" datetime="2015-06-12T20:50:48+08:00">4 days ago</time>
                      </li>
                      <li>
                        <a href="#!"><i class="mdi-editor-insert-invitation"></i> Director meeting started</a>
                        <time class="media-meta" datetime="2015-06-12T20:50:48+08:00">6 days ago</time>
                      </li>
                      <li>
                        <a href="#!"><i class="mdi-action-trending-up"></i> Generate monthly report</a>
                        <time class="media-meta" datetime="2015-06-12T20:50:48+08:00">1 week ago</time>
                      </li>
                    </ul>
                    <ul id="notifications-dropdown1" class="dropdown-content">
                      <li>
                        <h5>NOTIFICATIONS <span class="new badge">5</span></h5>
                      </li>
                      <li class="divider"></li>
                      <li>
                        <a href="ggfdgfd"><i class="mdi-action-add-shopping-cart"></i> A new order has been placed!</a>
                        <time class="media-meta" datetime="2015-06-12T20:50:48+08:00">2 hours ago</time>
                      </li>
                      <li>
                        <a href="#!"><i class="mdi-action-stars"></i> Completed the task</a>
                        <time class="media-meta" datetime="2015-06-12T20:50:48+08:00">3 days ago</time>
                      </li>
                      <li>
                        <a href="#!"><i class="mdi-action-settings"></i> Settings updated</a>
                        <time class="media-meta" datetime="2015-06-12T20:50:48+08:00">4 days ago</time>
                      </li>
                      <li>
                        <a href="#!"><i class="mdi-editor-insert-invitation"></i> Director meeting started</a>
                        <time class="media-meta" datetime="2015-06-12T20:50:48+08:00">6 days ago</time>
                      </li>
                      <li>
                        <a href="#!"><i class="mdi-action-trending-up"></i> Generate monthly report</a>
                        <time class="media-meta" datetime="2015-06-12T20:50:48+08:00">1 week ago</time>
                      </li>
                    </ul>
                    <ul id="user-dropdown" class="dropdown-content">
                      <!--li>
                        <h5>NOTIFICATIONS <span class="new badge">5</span></h5>
                      </li>
                      <li class="divider"></li-->
                        {% if request.user.is_authenticated %}
                              <li>
                                <a href="{% url 'my_logout' %}" class="myOwnLink"><i class="fa fa-sign-out" style="display: inline-block"></i>Se déconnecter</a>
                              </li>
                            <li>
                                <a href="#!" class="myOwnLink"><i class="fa fa-cogs" style="display: inline-block"></i>Paramètre</a>
                              </li>
                        {% else %}
                             <li>
                                <a href="{% url 'login' %}" class="myOwnLink" style="color: black"><i class="fa fa-sign-in" style="display: inline-block"></i> Se connecter</a>
                            </li>
                              <li>
                                <a href="{% url 'inscription' %}" class="myOwnLink"  style="color: black"><i class="fa fa-sign-out" style="display: inline-block"></i>S'inscrire</a>
                              </li>
                        {% endif %}

                    </ul>

                </div>
            </nav>
        </div>
        <!-- end header nav-->
    </header>
    <!-- END HEADER -->

    <!-- //////////////////////////////////////////////////////////////////////////// -->

    <!-- START MAIN -->
    <div id="main">
        <!-- START WRAPPER -->
        <div class="wrapper">

            <!-- START LEFT SIDEBAR NAV-->
            <aside id="left-sidebar-nav">
                <ul id="slide-out" class="side-nav fixed leftside-navigation">
                <li class="" style="background-color: gold">
                <div class="row">
                    <div class="col col s4 m4 l4" style="position: relative;top: 15px;">
                        <img src="{% static 'teranga_food_logo_192.png' %}" alt="" class="circle responsive-img valign profile-image hide-on-med-and-up">
                        <img src="{% static 'teranga_food_logo.png' %}" width="150" height="100" alt="" class="circle valign profile-image hide-on-small-only">
                    </div>
                    <div class="col col s8 m8 l8">
                        <!--ul id="profile-dropdown" class="dropdown-content">
                            <li><a href="#"><i class="mdi-action-face-unlock"></i> Profile</a>
                            </li>
                            <li><a href="#"><i class="mdi-action-settings"></i> Settings</a>
                            </li>
                            <li><a href="#"><i class="mdi-communication-live-help"></i> Help</a>
                            </li>
                            <li class="divider"></li>
                            <li><a href="#"><i class="mdi-action-lock-outline"></i> Lock</a>
                            </li>
                            <li><a href="#"><i class="mdi-hardware-keyboard-tab"></i> Logout</a>
                            </li>
                        </ul-->
                        {% if request.user.is_authenticated %}
                            <p >{{ request.user.client.personne.nomPersonne }} <!--i class="mdi-navigation-arrow-drop-down right"></i--></p>
                            <p style="position: relative;top: -35px;">{{ request.user.client.personne.prenomPersonne }}</p>
                        {% endif %}

                    </div>
                </div>
                </li>
                    {% block aside_nav %}
                    <li class="bold " style="background-color: gold;color: black;"><a href="{% url 'main_acceuil' %}" class="waves-effect waves-cyan"><i class="mdi-action-home"></i> Accueil</a>
                    {% if  request.user.is_authenticated %}
                        <li class="bold  hide-on-med-and-up"><a href="{% url 'my_logout' %}" class="waves-effect waves-cyan"><i class="fa fa-close"></i> Se déconnecter</a>
                        <li class="bold  "><a href="{% url 'mes_commandes' %}" class="waves-effect waves-cyan"><i class="fa fa-close"></i> Mes Commandes</a>
                    {% else %}
                        <li class="bold  hide-on-med-and-up"><a href="{% url 'login' %}" class="waves-effect waves-cyan"><i class="fa fa-sign-in"></i> Se connecter</a>
                        <li class="bold  hide-on-med-and-up"><a href="{% url 'inscription' %}" class="waves-effect waves-cyan"><i class="fa fa-sign-out"></i> S'inscrire</a>
                    {% endif %}
                    {% endblock %}

                </li>
<img src="{% static 'fyers-animé.gif' %}" width="240px" style="position: relative;top: 10px;">
<a href="https://play.google.com/store/apps/details?id=com.ec_innov.teranga" target="_blank"><img src="{% static 'play-store.png' %}" width="200px" height="60" style="position: relative;top: 10px;"></a>
<br><br><p class="text-center" ><i class="fa fa-mobile fa-2x"></i> (00221) 778399425</p>
<p class="text-center" ><a href=" mailto:contact@teranga-food.com"><i class="fa fa-envelope fa-2x"></i> contact@teranga-food.com</a> </p>
            </ul>


                <a href="#" data-activates="slide-out" class="sidebar-collapse btn-floating btn-medium waves-effect waves-light hide-on-large-only cyan" ><i class="mdi-navigation-menu" style="background-color: gold;"></i></a>
            </aside>
            <!-- END LEFT SIDEBAR NAV-->

            <!-- //////////////////////////////////////////////////////////////////////////// -->

            <!-- START CONTENT -->
            <section id="content" >
                <div id="modal1" class="modal">
    <div class="modal-content">
      <h4>Modal Header</h4>
      <p>A bunch of text</p>
    </div>
    <div class="modal-footer">
      <a href="#!" class="modal-action modal-close waves-effect waves-green btn-flat">Agree</a>
    </div>
  </div>
            <audio id="player_alert"  controls hidden>
                 <source src="{% static 'loop.mp3' %}"/>
            </audio>
                {% block main_block %}

                {% endblock %}
                <!--end container-->
            </section>
            <!-- END CONTENT -->

            <!-- //////////////////////////////////////////////////////////////////////////// -->
            <!-- START RIGHT SIDEBAR NAV-->

            <!-- LEFT RIGHT SIDEBAR NAV-->

        </div>
        <!-- END WRAPPER -->
<!-- modal  my basket-->
        <div class="modal fade" id="modaBasket" role="dialog" style="width: 350px;height: 400px;" >
              <!-- Modal content-->
            <div class="modal-header " style="background-color: gold;margin-bottom: 0px;width: 350px;">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h5 class="modal-title center" id="productTitle">Mon panier</h5>
            </div>
            <div class="modal-body" style="height: 230px;overflow: scroll">
                <table class="table table-responsive" >
                    <thead class="">
                    <tr>
                        <!--th>Images</th-->
                        <th>Libellé</th>
                        <th>PU</th>
                        <th>Qte</th>
                        <th>Total</th>
                        <th>Actions</th>
                    </tr>
                    </thead>
                    <tbody id="mon_panier_content">

                    </tbody>
                </table>

            </div>
            <p class="text-center">Total:<span style="color: red;font-size: 1.3em;font-weight: bold" class="" id="montantTotalBasket"></span> </p>
            <p ><!--button class="btn-flat " data-dismiss="modal"  style="color: black;background-color: gray;margin-right: 10px;">Non</button--><i style="color: gold;background-color: black;margin-right: 10px" id="btnRunCommande" class="fa fa-telegram fa-4x btn-floating btn-large halfway-fab waves-effect waves-light pulse right"></i></p>

        </div>
    <!-- end modal  my basket-->

    <!-- modal  my basket-->
        <div class="modal fade l8" id="modaEmptyBasket" role="dialog" style="width: 260px;height: 200px;" >
              <!-- Modal content-->
            <div class="modal-header" style="background-color: gold;margin-bottom: 0px;width: 260px;">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h5 class="modal-title center" id="productTitle">Mon panier</h5>
            </div>
            <div class="modal-body" style="">
               <p class="text-center">votre panier est vide</p>
               <p class="text-center"><button class="btn-flat " data-dismiss="modal"  style="color: black;background-color: gold">Ok</button></p>
            </div>
        </div>
    <!-- end modal  my basket-->






    <!-- modal  quantite-->
        <div class="modal fade" id="modalUpdateQte" role="dialog" style="width: 330px;height: 240px;" >
              <!-- Modal content-->
            <div class="modal-header" style="background-color: gold;margin-bottom: 0px;">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h5 class="modal-title center" id="mUProductTitle"></h5>
            </div>
            <!--h5 class="center-align" id="txt_title_prod"></h5-->
             <div class="row" style="color: black;margin-top: 10px">
                 <table class="table table-responsive" style="margin: 0px;">
                    <thead>
                    <tr>
                        <!--th>Images</th-->
                        <th>PU</th>
                        <th>Qte</th>
                        <th>Total</th>
                        <th>Actions</th>
                    </tr>
                    </thead>
                    <tbody id="mon_panier_content">
                    <tr>
                        <!--th>Images</th-->
                        <td style="padding-top: 15px"><span id="updatePrize"></span> Fcfa</td>
                        <td style="padding-top: 15px" id="updateQte"></td>
                        <td style="padding-top: 15px"><span id="update_total"></span> Fcfa</td>
                        <td>
                            <i style="color: gold" id="btnUpdateQtePlus" class="fa fa-plus-circle fa-3x" ></i>
                            <i style="color: gray" id="btnUpdateQteMoins" class="fa fa-minus-circle fa-3x" ></i>
                            <i style="color: red" id="btnUpdateQteRemove" class="fa fa-trash-o fa-3x" id="btnUpdateRemove"></i>
                        </td>
                    </tr>
                    </tbody>
                </table>
                                <!--div class="col-lg-4 col-xs-4 col-lg-offset-2 col-xs-offset-2">
                                    <p id="mUnbr_qte" style="position: relative;top: 45px;color: black;font-size: 1.6em;font-weight: bold;" class="pull-right"></p>
                                </div>
                                <div class="col-lg-4 col-xs-4" >
                                    <p style=""><a class="btn-flat btn-large" id="mUbtn_plus" style="color: black;background-color: gold"><i class="fa fa-plus-circle fa-5x"></i></a></p>
                                    <p style=""><a class=" btn-flat btn-large" id="mUbtn_moins" style="color: black;background-color: darkgray"><i class="fa fa-minus-circle fa-5x"></i></a></p>
                                </div-->
                            </div>
        <p class="text-center"><button id="btnAddInBasketConf" class="btn-flat " data-dismiss="modal" style="background-color: gold;">Terminer</button></p>
        </div>
    <!-- end modal  quantite-->

     <!-- modal  confirmationRemove-->
        <div class="modal fade l8" id="modalConfRemove" role="dialog" style="width: 260px;height: 180px;" >
              <!-- Modal content-->
            <div class="modal-header" style="background-color: gold;margin-bottom: 0px;">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h5 class="modal-title center" id="productTitle"></h5>
            </div>
            <div class="modal-body" style="">
               <p class="text-center">Voulez vous rétirer <span id="productToRemove"></span> de votre panier?</p>
               <!--p class="text-center"></p-->
               <p class="text-center"><button class="btn-flat " data-dismiss="modal"  style="color: black;background-color: gray;margin-right: 10px;">Non</button><button id="btnRemoveConf" class="btn-flat " style="color: black;background-color: gold">Oui</button></p>
            </div>
        </div>
    <!-- end modal  confirmationRemove-->

    <!-- modal  detailCommande-->
        <div class="modal fade l8" id="modalPreCommande" role="dialog" style="width: 300px;height: 300px;" >
              <!-- Modal content-->
            <div class="modal-header" style="background-color: gold;margin-bottom: 0px;width: 300px;">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h5 class="modal-title center" id="productTitle"></h5>
            </div>
            <div class="modal-body" style="">

                <table class="table table-responsive" style="margin: 0px;">
                    <thead>
                    <tr>
                        <!--th>Images</th-->
                        <th>Commande:</th>
                        <th id="montantCommande"></th>

                    </tr>
                    <tr>
                        <!--th>Images</th-->
                        <th>TVA:</th>
                        <th id="montantTva"></th>
                    </tr>
                    <tr>
                        <!--th>Images</th-->
                        <th>Frais de livraison:</th>
                         <th id="montantLivraison"></th>
                    </tr>
                     <tr style="color: red">
                        <!--th>Images</th-->
                        <th>Total:</th>
                        <th id="montantTotal"></th>
                    </tr>
                    </thead>
                </table>
               <p class="text-center" style="margin-top: 15px;"><button class="   " data-dismiss="modal"  style="color: black;background-color: gray;margin-right: 10px;width: 100px;padding: 5px;border-radius: 5px">Annuler</button><button id="btnContinuer"  style="color: black;background-color: gold;margin-right: 10px;width: 100px;padding: 5px;border-radius: 5px">Continuer</button></p>
            </div>
        </div>
    <!-- end modal  detailCommande-->

    <!-- modal  position-->
        <div class="modal fade l8" id="modalPosion" role="dialog" style="width: 260px;height: 200px;" >
              <!-- Modal content-->
            <div class="modal-header" style="background-color: gold;margin-bottom: 0px;">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h5 class="modal-title center" id="productTitle"></h5>
            </div>
            <div class="modal-body" style="">
               <p class="text-center">Pour faciliter la livraison, veuillez autoriser Teranga-Food à recuperer votre position  </p>
               <!--p class="text-center"></p-->
                <p class="text-center" style="margin-top: 15px;"><button class="   " data-dismiss="modal"  style="color: black;background-color: gray;margin-right: 10px;width: 100px;padding: 5px;border-radius: 5px">Je refuse</button><button id="btnGpsOk"  style="color: black;background-color: gold;margin-right: 10px;width: 100px;padding: 5px;border-radius: 5px">J'accepte</button></p>
            </div>
        </div>
    <!-- end modal  position-->



    <!-- modal  auth-->
        <div class="modal fade l8" id="modalAuth" role="dialog" style="width: 300px;height: 250px;" >
              <!-- Modal content-->
            <div class="modal-header" style="background-color: gold;margin-bottom: 0px;width: 300px;">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h5 class="modal-title center" id="productTitle">Authentification</h5>
            </div>
            <div class="modal-body" style="">
                <p style="margin: 0px;">veuillez entrer votre code secret</p>
                <form class="form-signin" method="post"  action="{% url 'login' %}">
                    <input type="password" id="password" name="password" class="form-control" placeholder="****" required>
                    <p style="color: red;margin-top:-10px; " id="authError" ></p>

                </form>
               <p class="text-center"> </p>
               <!--p class="text-center"></p-->
                <p class="text-center" style="margin-top: 15px;"><button class="   " data-dismiss="modal"  style="color: black;background-color: gray;margin-right: 10px;width: 100px;padding: 5px;border-radius: 5px">Annuler</button><button id="btnAuth"  style="color: black;background-color: gold;margin-right: 10px;width: 100px;padding: 5px;border-radius: 5px">Terminer</button></p>
            </div>
        </div>
    <!-- end modal  position-->

    <!-- modal  runCommande-->
        <div class="modal fade l8" id="modalRunCmd" role="dialog" style="width: 260px;height: 160px;" >
              <!-- Modal content-->
            <div class="modal-header" style="background-color: gold;margin-bottom: 0px;">
                <!--button type="button" class="close" data-dismiss="modal">&times;</button-->
                <h5 class="modal-title center" id="productTitle"></h5>
            </div>
            <div class="modal-body" style="">
                <p class="text-center"><img src="{% static 'refr.gif' %}" width="50"></p>
                <p class="text-center" id="txtForWait">commande en cours ...</p>
               <!--p class="text-center"></p-->
               <!--p class="text-center"><button class="btn-flat " data-dismiss="modal"  style="color: black;background-color: gray;margin-right: 10px;">Non</button><button id="btnRemoveConf" class="btn-flat " style="color: black;background-color: gold">Oui</button></p-->
            </div>
        </div>
    <!-- end modal  runCommande-->

    <!-- modal  runCommandeError-->
        <div class="modal fade l8" id="modalRunCmdError" role="dialog" style="width: 300px;height: 180px;" >
              <!-- Modal content-->
            <div class="modal-header" style="background-color: gold;margin-bottom: 0px;">
                <!--button type="button" class="close" data-dismiss="modal">&times;</button-->
                <h5 class="modal-title center" id="productTitle"></h5>
            </div>
            <div class="modal-body" style="">
                <p class="text-center" id="runCommandeError"></p>
               <!--p class="text-center"></p-->
               <p class="text-center"><!--button class="btn-flat " data-dismiss="modal"  style="color: black;background-color: gray;margin-right: 10px;">Non</button--><button id="btnRemoveConf" class="btn-flat " data-dismiss="modal" style="color: black;background-color: gold">Ok</button></p>
            </div>
        </div>
    <!-- end modal  runCommandeError-->

<!-- modal  block_alert-->
        <div class="modal fade l8" id="block_alert" role="dialog" style="width: 300px;height: 350px;" >
              <!-- Modal content-->
            <div class="modal-header" style="background-color: gold;margin-bottom: 0px;">
                <!--button type="button" class="close" data-dismiss="modal">&times;</button-->
                <h5 class="modal-title center" id="productTitle"></h5>
            </div>
            <div class="modal-body" >
               <p class="center-align" id=""  style="margin: 0px"><img src="{% static 'livreur_app.jpg' %}" width="200" height="170"></p>
               <p class="center-align" id="" style="margin: 0px">votre livreur est à proximité</p>
               <p class="center-align" id=""  style="margin: 0px">Veuillez sortir pour récuperer votre commande</p>

               <p class="text-center"><button id="btn_alert_yes" class="btn-flat " data-dismiss="modal" style="color: black;background-color: gold">Ok</button><!--button class="btn-flat " data-dismiss="modal"  style="color: black;background-color: gray;margin-right: 10px;">Non</button--><!--button id="btnRemoveConf" class="btn-flat " data-dismiss="modal" style="color: black;background-color: gold">Ok</button--></p>
            </div>
        </div>
    <!-- end modal  block_alert-->


    <!-- modal  block_alert-->
        <div class="modal fade l8" id="block_notification" role="dialog" style="width: 300px;height: 200px;" >
              <!-- Modal content-->
            <div class="modal-header" style="background-color: gold;margin-bottom: 0px;">
                <!--button type="button" class="close" data-dismiss="modal">&times;</button-->
                <h5 class="modal-title center" id="productTitle"></h5>
            </div>
            <div class="modal-body" >
               <p class="center-align" id="" style="margin: 0px">Pour suivre en temps réel l'état de vos futures commandes, veuillez autoriser Téranga-Food à afficher des notifications sur votre bureau!</p>
               <p class="text-center"><button class="btn-flat " data-dismiss="modal"  style="color: black;background-color: gray;margin-right: 10px;">Non</button><button id="btn_accept_Notification_push" class="btn-flat "  style="color: black;background-color: gold">Ok</button></p>
            </div>
        </div>
    <!-- end modal  block_alert-->




    <!-- modal  block_alert-->
        <div class="modal fade l8" id="block_location_denied" role="dialog" style="width: 300px;height: 200px;" >
              <!-- Modal content-->
            <div class="modal-header" style="background-color: gold;margin-bottom: 0px;">
                <!--button type="button" class="close" data-dismiss="modal">&times;</button-->
                <h5 class="modal-title center" id="productTitle"></h5>
            </div>
            <div class="modal-body" >

               <p class="center-align" id=""  style="margin: 0px">Désolé, vous ne pouvez commadez que si vous autoriez Teranga-Food à obtenir votre position. Veuillez acceder au parametre de votre navigateur afin de modifier ceci.</p>

               <p class="text-center"><!--button class="btn-flat " data-dismiss="modal"  style="color: black;background-color: gray;margin-right: 10px;">Non</button--><button id="" class="btn-flat " data-dismiss="modal" style="color: black;background-color: gold">Ok</button></p>
            </div>
        </div>
    <!-- end modal  block_alert-->



 <!-- modal  confirmationRemove-->
        <div class="modal fade l8" id="modalBadCoordonne" role="dialog" style="width: 310px;height: 280px;" >
              <!-- Modal content-->
            <div class="modal-header" style="background-color: gold;margin-bottom: 0px;width: 310px;">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h5 class="modal-title center" id="productTitle"></h5>
            </div>
            <div class="modal-body" style="">
               <p class="text-center">Désolé, nos services sont limités à une distance définie. veillez vous rassurer que la distance entre vous et le restaurant ne dépasse pas 7 km. Ou bien les coordonnées fournie par google ne sont pas bonne.Veuillez ouvrir <a href="https://www.google.sn/maps/@14.7645042,-17.3660286,11z" target="_blank">google maps</a> et vérifier votre position actuelle </p>
               <!--p class="text-center"></p-->
               <p class="text-center"><button class="btn-flat " data-dismiss="modal"  style="color: black;background-color: gray;margin-right: 10px;">ok</button></p>
            </div>
        </div>
    <!-- end modal  confirmationRemove-->



    </div>
    <!-- END MAIN -->



    <!-- //////////////////////////////////////////////////////////////////////////// -->

    <!-- START FOOTER -->
    <footer class="page-footer" style="z-index: 11111111111">

        <!--div class="footer-copyright">
            <div class="container">
                Copyright © 2015 <a class="grey-text text-lighten-4" href="http://themeforest.net/user/geekslabs/portfolio?ref=geekslabs" target="_blank">GeeksLabs</a> All rights reserved.
                <span class="right"> Design and Developed by <a class="grey-text text-lighten-4" href="http://geekslabs.com/">GeeksLabs</a></span>
            </div>
        </div-->
        <div class="center" style="  position: fixed;bottom: 0;background-color: black;width: 100%;z-index: 20000000">
                                    <span class="grey-text" style="display: inline-block">&copy; 2016-2017.<a style="display: inline-block" href="http://www.ec-innov.com" target="_blank"><img style="position: relative;" src="{% static 'logo_ec_innov.png' %}" width="20" height="20">&nbsp;Ec-Innov</a></span>
                                </div>
    </footer>
    <!-- END FOOTER -->


    <!-- ================================================
    Scripts
    ================================================ -->


    <!-- jQuery Library -->
    <script type="text/javascript" src="{% static 'myTemplate/js/plugins/jquery-1.11.2.min.js'%}"></script>
    <!--materialize js-->
    <script type="text/javascript" src="{% static 'myTemplate/js/materialize.min.js'%}"></script>
    <!--scrollbar-->
    <script type="text/javascript" src="{% static 'myTemplate/js/plugins/perfect-scrollbar/perfect-scrollbar.min.js'%}"></script>


    <!-- chartist -->
    <!--script type="text/javascript" src="{% static 'myTemplate/js/plugins/chartist-js/chartist.min.js'%}"></script-->

    <!-- chartjs -->
    <!--script type="text/javascript" src="{% static 'myTemplate/js/plugins/chartjs/chart.min.js'%}'%}"></script-->
    <!--script-- type="text/javascript" src="{% static 'myTemplate/js/plugins/chartjs/chart-script.js'%}"></script-->

    <!-- sparkline -->
    <script type="text/javascript" src="{% static 'myTemplate/js/plugins/sparkline/jquery.sparkline.min.js'%}"></script>
    <script type="text/javascript" src="{% static 'myTemplate/js/plugins/sparkline/sparkline-script.js'%}"></script>

    <!-- google map api -->
    <!--script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAAZnaZBXLqNBRXjd-82km_NO7GUItyKek"></script-->

    <!--jvectormap-->
    <script type="text/javascript" src="{% static 'myTemplate/js/plugins/jvectormap/jquery-jvectormap-1.2.2.min.js'%}"></script>
    <script type="text/javascript" src="{% static 'myTemplate/js/plugins/jvectormap/jquery-jvectormap-world-mill-en.js'%}"></script>
    <script type="text/javascript" src="{% static 'myTemplate/js/plugins/jvectormap/vectormap-script.js'%}"></script>

    <!--google map-->
    <!--script type="text/javascript" src="{% static 'myTemplate/js/plugins/google-map/google-map-script.js'%}"></script-->


    <!--plugins.js - Some Specific JS codes for Plugin Settings-->
    <script type="text/javascript" src="{% static 'myTemplate/js/plugins.min.js'%}"></script>
    <!--custom-script.js - Add your own theme custom JS-->
    <!--script type="text/javascript" src="{% static 'myTemplate/js/custom-script.js'%}"></script-->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
     <script src="{% static 'amplify/amplify.min.js'%}"></script>
    <!-- Toast Notification -->
    <script type="text/javascript">
    // Toast Notification
    var nbrNotificationNonRead=0;
    var password=0;
    var longitude=0;
    var latitude=0;
    var tarifDef=null;
    function distance(lat1, lon1, lat2, lon2) {
      var radlat1 = Math.PI * lat1/180
      var radlat2 = Math.PI * lat2/180
      var theta = lon1-lon2
      var radtheta = Math.PI * theta/180
      var dist = Math.sin(radlat1) * Math.sin(radlat2) + Math.cos(radlat1) * Math.cos(radlat2) * Math.cos(radtheta);
      dist = Math.acos(dist)
      dist = dist * 180/Math.PI
      dist = dist * 60 * 1.1515
      dist=(dist* 1.609344)*1000
      //if (unit=="K") { dist = dist * 1.609344 }
      //if (unit=="N") { dist = dist * 0.8684 }
      return dist
    }
    function  getLocation(position) {
      {% if request.user.is_authenticated %}
        longitude=position.coords.longitude;
        latitude=position.coords.latitude;
        console.log(longitude);
        console.log(latitude);
        
        tmp_name="commande_"+{{ request.user.username }};
        liste=amplify.store(tmp_name);
        console.log(liste[0].entite);
        var csrftoken = getCookie('csrftoken');
        $.ajax({
                            //url : "http://192.168.2.128/CARTALINK%20API/bank/creerCompteMinimal",
                  url :"{% url 'get_entity_coord' %}",
                  type : "POST", // http method
                  timeout:100000,
                  data: {idEntite:liste[0].entite},
                            beforeSend: function(xhr){xhr.setRequestHeader("X-CSRFToken", csrftoken);},
                            success : function(json)
                            {
                              var resultat=JSON.parse(String(json));
                              dist=distance(latitude,longitude,14.715665,-17.466219/*resultat.latitude, resultat.longitude*/);
                              console.log(dist);
                              tarif=null;
                              
                              for (var i = 0; i < resultat.listeTarif.length; i++) {
                                tarif=resultat.listeTarif[i];
                                if(dist>tarif.min && dist<tarif.max)
                                {
                                  tarifDef=tarif;
                                }
                              }
                              $('#modalRunCmd').modal('hide');
                              $("#txtForWait").text("commande en cours ...");

                              tmp_name="commande_"+{{ request.user.username }};
                              liste=amplify.store(tmp_name);
                              somme=0;
                              for(i=0;i<liste.length;i++)
                              {
                                   if(liste[i].isStart==0)
                                   {
                                       tmp=liste[i].quantite*liste[i].prix;
                                       somme+=tmp;
                                   }

                              }
                              if(tarifDef!=null)
                              {
                                total=somme+parseInt(tarifDef.prix);
                                $("#montantTotal").text(total+" Fcfa");
                                $("#montantLivraison").text(tarifDef.prix+" Fcfa");
                                $("#montantCommande").text(somme+" Fcfa");
                                $('#montantTva').text('0 Fcfa');
                                $('#modalPreCommande').modal('show');
                              }
                              else
                              {
                                $('#modalBadCoordonne').modal('show');
                                
                              }
                              
                            },
                            error :function(xhr,errmsg,err)
                                {
                                  console.log(xhr);
                                }
                });

{% endif %}

        /*tmp_name="commande_"+{{ request.user.username }};
        liste=amplify.store(tmp_name);
        console.log(liste[0].entite);
        console.log(distance(latitude,longitude,14.712931, -17.467184));

        $('#modalPosion').modal('hide');
        $('#modalAuth').modal('show');*/

    }

    function showError(error) {
        value="";
    switch(error.code) {

        case error.PERMISSION_DENIED:
            $('#modalRunCmd').modal('hide');
            $("#block_location_denied").modal('show');
            break;
        case error.POSITION_UNAVAILABLE:
            value = "Location information is unavailable."
            break;
        case error.TIMEOUT:
            value = "The request to get user location timed out."
            break;
        case error.UNKNOWN_ERROR:
            value = "An unknown error occurred."
            break;
    }
    //console.log(value);
}



    $(window).ready(function() {
        var selectedRow;
        var productToremove=0;
        var somme=0;
        updateNuberItemInBasket();
        // $("#player_alert").get(0).play();
                //$('#block_alert').modal('show');
                $("#btn_alert_yes").click(function () {
                     $('#block_alert').modal('hide');
                     $("#player_alert").get(0).pause();
                });

                 {% if request.user.is_authenticated %}
                      if (("Notification" in window)) {
        if (Notification.permission !== "granted") {
        // If it's okay let's create a notification block_notification
            $('#block_notification').modal('show');
            $("#btn_accept_Notification_push").click(function () {
                $('#block_notification').modal('hide');

                Notification.requestPermission(function (permission) {
                  if (!('permission' in Notification)) {
                    Notification.permission = permission;
                  }

              // If the user is okay, let's create a notification
              if (permission === "granted") {
                var options = {
                body: "Félicitations!",
                icon: "{% static 'teranga_food_logo_192.png' %}",
                dir : "ltr"
            };
                var notification = new Notification("Notification",options);
              }
        });


            });
      }
      }
        {% endif %}

        $(".btnNotification").click(function () {
            $(".nbr_notifications").text("");
            $(".nbr_notifications").hide();
            nbrNotificationNonRead=0;
        });
        $("#btnAuth").click(function () {
            {% if request.user.is_authenticated %}
                isError=0;
            if($("#password").val()=="")
            {
                isError++;
                $("#authError").text("Veuillez entrer votre code secret");
            }
            else
            {
                if($("#password").val().length==4)
                {
                   password=$("#password").val();
                   $("#password").val("");
                   $('#modalAuth').modal('hide');
                   $('#modalRunCmd').modal('show');
                   var csrftoken = getCookie('csrftoken');
                   tmp_name="commande_"+{{ request.user.username }};
                    liste=amplify.store(tmp_name);
                    ligne_commande='[';
                    for(i=0;i<liste.length;i++)
                     {
                         if(liste[i].isStart==0)
                         {
                             commande=liste[i];
                             ligne_commande+='{';
                             ligne_commande+='"idProduit":"'+commande.id+'",';
                             ligne_commande+='"quantite":"'+commande.quantite+'"';
                             if(i==liste.length-1)
                             {
                                 ligne_commande+='}';
                             }
                             else
                             {
                                 ligne_commande+='},';
                             }
                         }
                     }
                     ligne_commande+=']';
                     json_post='{';
                     json_post+='"longitude":"'+longitude+'",';
                     json_post+='"latitude":"'+latitude+'",';
                     json_post+='"produits":'+ligne_commande+'';
                     json_post+='}';
                     locality=amplify.store("locality");
                     locality=1;
                   $.ajax({
                            //url : "http://192.168.2.128/CARTALINK%20API/bank/creerCompteMinimal",
                             url :"{% url 'nouvelle_commande' %}",
                            type : "POST", // http method
                            timeout:100000,
                            data: {client:"{{ request.user.username }}", data:json_post,password:password,idEntite:liste[0].entite,idLocalite:4,prixLivraison:tarifDef.prix},
                            beforeSend: function(xhr){xhr.setRequestHeader("X-CSRFToken", csrftoken);},
                            success : function(json)
                            {
                                $('#modalRunCmd').modal('hide');
                                $('#modaBasket').modal('hide');
                                tmp_name="commande_"+{{ request.user.username }};
                                 mlocality=amplify.store("locality");
                                 if(mlocality!=null )
                                 {
                                     amplify.store("locality","");
                                 }
                                liste=amplify.store(tmp_name);
                                liste=[];
                                amplify.store(tmp_name,liste);
                                updateNuberItemInBasket();
                                $('#modalPreCommande').modal('hide');


                                Materialize.toast('<span>votre commande a été lancée avec succès!<br>vous pouvez dès maintenant suivre en temp réel  de votre commande </span>', 5000);
                                 setTimeout(function() {
                                    document.location="{% url 'mes_commandes' %}";
                                }, 5000);
                                 //$("#before").hide();
                                 //$("#txtAfter").html("<p class=\"center-align\" id=\"txtAfter\">Votre nouveau code de validation vous envoyé par sms sur le numero <span class=\"text-primary\" id=\"_email\">{{ client.personne.numeroPersonne }}</span><p>");
                                 //$("#after").show();
                                 //token=json;

                            },
                            error :
                                function(xhr,errmsg,err)
                                {
                                  console.log(xhr);
                                     if(xhr.status==403)
                                    {
                                        $('#modalRunCmd').modal('hide');
                                        $("#authError").text("code incorrect");
                                        $('#modalAuth').modal('show');
                                    }
                                    else
                                     {
                                         $('#modalRunCmd').modal('hide');
                                         $('#runCommandeError').text(xhr.responseText);
                                         $('#modalRunCmdError').modal('show');

                                     }
                                    //$("#before").hide();
                                    //$("#txtAfter").text(xhr.responseText);
                                    //$("#after").show();
                                }
                        });
                }
                else
                {
                    isError++;
                    $("#authError").text("code incorrect");
                }
            }
            {% endif %}

        });
        $("#btnGpsOk").click(function () {
            if (navigator.geolocation)
            {
                navigator.geolocation.getCurrentPosition(getLocation,showError);
                //alert("good");
            }

        });
        $("#btnContinuer").click(function () {
          $('#modalPreCommande').modal('hide');
          $('#modalAuth').modal('show');
          //navigator.geolocation.getCurrentPosition(getLocation,showError);
            //$('#modalPosion').modal('show');
        });
        $("#btnRunCommande").click(function () {
          $("#txtForWait").text("veuillez patienter ...");
          $('#modalRunCmd').modal('show');
          {% if request.user.is_authenticated %}
            navigator.geolocation.getCurrentPosition(getLocation,showError);
          {% endif %}
            /*{% if request.user.is_authenticated %}
            tmp_name="commande_"+{{ request.user.username }};
             liste=amplify.store(tmp_name);
            liste=amplify.store(tmp_name);
            somme=0;
            for(i=0;i<liste.length;i++)
            {
                 if(liste[i].isStart==0)
                 {
                     tmp=liste[i].quantite*liste[i].prix;
                     somme+=tmp;
                 }

            }
            total=somme+1000;
            $("#montantTotal").text(total+" Fcfa");
            $("#montantLivraison").text(1000+" Fcfa");
            $("#montantCommande").text(somme+" Fcfa");
            $('#montantTva').text('0 Fcfa');
            $('#modalPreCommande').modal('show');
            {% endif %}*/
        });
        $("#btnUpdateQtePlus").click(function () {
            {% if request.user.is_authenticated %}
             tmp_name="commande_"+{{ request.user.username }};
             liste=amplify.store(tmp_name);
             for(i=0;i<liste.length;i++)
                {
                    if(liste[i].cmd_id==selectedRow.attr("id"))
                    {
                        if(liste[i].quantite<10)
                        {
                            liste[i].quantite++;
                           $("#updateQte").text(liste[i].quantite);
                           $("#update_total").text(liste[i].quantite*liste[i].prix);
                           selectedRow.find(".quantite").text(liste[i].quantite)
                            tmp=liste[i].quantite*liste[i].prix;
                           selectedRow.find(".total").text(tmp+" Fcfa");
                           amplify.store(tmp_name,liste);
                           liste=amplify.store(tmp_name);
                           total=0;
                           for(i=0;i<liste.length;i++)
                           {
                                tmp=liste[i].quantite*liste[i].prix;
                                total+=tmp;
                           }
                           $("#montantTotalBasket").text(total+" Fcfa");
                        }

                    }
                }
            {% endif %}

        });
         $("#btnRemoveConf").click(function () {
             {% if request.user.is_authenticated %}
             tmp_name="commande_"+{{ request.user.username }};
             liste=amplify.store(tmp_name);
             liste.splice(productToremove,1);
             selectedRow.hide();
             amplify.store(tmp_name,liste);
             updateNuberItemInBasket();
             $("#modalUpdateQte").modal("hide");
             liste=amplify.store(tmp_name);
             total=0;
             for(i=0;i<liste.length;i++)
             {
                 tmp=liste[i].quantite*liste[i].prix;
                 total+=tmp;
             }
             $("#montantTotalBasket").text(total+" Fcfa");
             $('#modalConfRemove').modal('hide');
              tmpTotal=0;
                  for(i=0;i<liste.length;i++)
                 {
                     if(liste[i].isStart==0)
                       {
                           tmpTotal++;
                       }
                 }
             if(tmpTotal==0)
             {
                 $('#modaBasket').modal('hide');
             }
             //alert("good");
             {% endif %}
         });
         $("#btnUpdateQteMoins").click(function () {
            {% if request.user.is_authenticated %}
             tmp_name="commande_"+{{ request.user.username }};
             liste=amplify.store(tmp_name);
             for(i=0;i<liste.length;i++)
                {
                    if(liste[i].cmd_id==selectedRow.attr("id"))
                    {
                        if(liste[i].quantite>1)
                        {
                            liste[i].quantite--;
                            $("#updateQte").text(liste[i].quantite);
                            $("#update_total").text(liste[i].quantite*liste[i].prix);
                            selectedRow.find(".quantite").text(liste[i].quantite)
                            tmp=liste[i].quantite*liste[i].prix;
                            selectedRow.find(".total").text(tmp+" Fcfa");
                            amplify.store(tmp_name,liste);
                            liste=amplify.store(tmp_name);
                           total=0;
                           for(i=0;i<liste.length;i++)
                           {
                                tmp=liste[i].quantite*liste[i].prix;
                                total+=tmp;
                           }
                           $("#montantTotalBasket").text(total+" Fcfa");
                        }

                    }
                }
            {% endif %}

        });



         $("#btnUpdateQteRemove").click(function () {


            {% if request.user.is_authenticated %}
             tmp_name="commande_"+{{ request.user.username }};
             liste=amplify.store(tmp_name);
             for(i=0;i<liste.length;i++)
                {
                    if(liste[i].cmd_id==selectedRow.attr("id"))
                    {
                         $('#productToRemove').text(liste[i].libelle);
                        $('#modalConfRemove').modal('show');
                        productToremove=i;
                        /*liste.splice(i,1);
                        selectedRow.hide();
                        amplify.store(tmp_name,liste);
                        updateNuberItemInBasket();
                        $("#modalUpdateQte").modal("hide");
                         liste=amplify.store(tmp_name);
                         if(liste.length==0)
                         {
                             $('#modaBasket').modal('hide');
                         }*/
                    }
                }
            {% endif %}

        });
        updateNuberItemInBasket();
        $(".myOwnLink").click(function () {
            document.location=$(this).attr("href");
        });
        $(".btnMyBasket").click(function () {
            {% if request.user.is_authenticated %}
             tmp_name="commande_"+{{ request.user.username }};
             liste=amplify.store(tmp_name);
             _html="";
             if(liste && liste.length!=0)
             {
                  tmpTotal=0;
                  for(i=0;i<liste.length;i++)
                 {
                     if(liste[i].isStart==0)
                       {
                           tmpTotal++;
                       }
                 }
                 if(tmpTotal==0)
                 {
                     $('#modaEmptyBasket').modal('show');
                 }
                 else
                 {
                     somme=0;
                 for(i=0;i<liste.length;i++)
                 {
                      if(liste[i].isStart==0)
                       {
                           tmp=liste[i].quantite*liste[i].prix;
                             somme+=tmp;
                            _html+='<tr id="'+liste[i].cmd_id+'">' +
                             '<td>'+liste[i].libelle+'</td>' +
                             '<td>'+liste[i].prix+' Fcfa</td>' +
                             '<td class="quantite">'+liste[i].quantite+'</td>' +
                             '<td class="total">'+tmp+' Fcfa</td>' +
                             '<td><button class="btn btnOption" style="background-color:gold"><i class="fa fa-ellipsis-h"></button></i></td>' +
                             '</tr>';
                            $("#mon_panier_content").html(_html);
                            $(".btnOption").click(function () {
                                selectedRow=$(this).parent().parent();
                                for(i=0;i<liste.length;i++)
                                {
                                    if(liste[i].cmd_id==selectedRow.attr("id"))
                                    {
                                        commande=liste[i];
                                        $("#mUProductTitle").text(commande.libelle);
                                        $("#updatePrize").text(commande.prix);
                                        $("#updateQte").text(commande.quantite);
                                        tmp=commande.prix*commande.quantite;
                                        $("#update_total").text(tmp);
                                        $("#modalUpdateQte").modal("show");
                                    }
                                }
                            });
                       }



                 }
                 $("#montantTotalBasket").text(somme+" Fcfa");
                 $('#modaBasket').modal('show');
                 }



             }
             else
             {
                 $('#modaEmptyBasket').modal('show');
             }
         {% endif %}

        });

        


        /*---------------------------------------------- notification ----------------------------------------------*/
                      setInterval(function () {
                        {% if request.user.is_authenticated %}
                          var csrftoken = getCookie('csrftoken');
                                  $.ajax({
      
                                            url :"{% url 'get_notification' %}",
                                            type : "POST", // http method
                                            timeout:100000,
                                            async:true,
                                            beforeSend: function(xhr){xhr.setRequestHeader("X-CSRFToken", csrftoken);},
                                            success : function(json)
                                            {
                                               try{
                                                     var notifications=JSON.parse(String(json));
                                                 tab_tmp=[];
                                                 for(i=0;i<notifications.length;i++)
                                                {
                                                    _html='<li style="margin: 0px;padding: 0px;border-top: solid 1px gold;">';
                                                    _html+='<a class="myOwnLink" href="'+notifications[i].fields.url+'">';
                                                    _html+='<h6 style="margin: 0px;color: gold;">'+notifications[i].fields.titre+'</h4>';
                                                    _html+=notifications[i].fields.content;
                                                    _html+='</a><li>';
                                                    Materialize.toast('<span>'+notifications[i].fields.content+'</span>', 5000);
                                                    nbrNotificationNonRead=nbrNotificationNonRead+1;
                                                        $(".nbr_notifications").text(nbrNotificationNonRead);
                                                    $(".blocNotification").prepend(_html);
                                                    $(".nbr_notifications").show();
                                                      $(".myOwnLink").click(function () {
                                                            document.location=$(this).attr("href");
                                                        });
                                                    if(parseInt(notifications[i].fields.Notitype)==10)
                                                        {
                                                            $("#player_alert").get(0).play();
                                                            $('#block_alert').modal('show');
                                                            Materialize.toast('<span>votre livreur est à proximité <br>Veuillez sortir pour récuperer votre commande</span>', 5000);
                                                            notifyMe("votre livreur est à proximité. Veuillez sortir pour récuperer votre commande")
                                                        }
                                                }
                                               }catch (e)
                                               {
                                               }

                                            }
                                 }); {% endif %}

                      },10000);
/**-------------------------------------------- end notification-----------------------------------------*/


    });
    function updateNuberItemInBasket() {
         {% if request.user.is_authenticated %}
             tmp_name="commande_"+{{ request.user.username }};
             liste=amplify.store(tmp_name);
             if(liste && liste.length!=0)
             {
                 tmpTotal=0;
                 for(i=0;i<liste.length;i++)
                 {
                       if(liste[i].isStart==0)
                       {
                           tmpTotal++;
                       }
                 }
                 if(tmpTotal==0)
                 {
                      $(".nbr_basket_items").hide();
                 }
                 else
                 {
                    $(".nbr_basket_items").text(tmpTotal);
                    $(".nbr_basket_items").addClass("badge blue");
                    $(".nbr_basket_items").show();
                 }
             }
             else
             {
              $(".nbr_basket_items").text("3");
                 $(".nbr_basket_items").hide();
             }
             {% else %}

             $(".btnMyBasket").hide();
         {% endif %}
        }
         function getCookie(name) {
            var cookieValue = null;
            if (document.cookie && document.cookie != '') {
                var cookies = document.cookie.split(';');
                for (var i = 0; i < cookies.length; i++) {
                    var cookie = jQuery.trim(cookies[i]);
                    // Does this cookie string begin with the name we want?
                    if (cookie.substring(0, name.length + 1) == (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
          }



    function notifyMe(text)
    {
      // Let's check if the browser supports notifications
      if (!("Notification" in window)) {
        //alert("This browser does not support desktop notification");
      }
      // Let's check if the user is okay to get some notification
      else if (Notification.permission === "granted") {
        // If it's okay let's create a notification
      var options = {
            body: text,
            icon: "{% static 'teranga_food_logo1.png' %}",
            dir : "ltr"
        };
      var notification = new Notification("Notification",options);
      }

      // Otherwise, we need to ask the user for permission
      // Note, Chrome does not implement the permission static property
      // So we have to check for NOT 'denied' instead of 'default'
      else if (Notification.permission !== 'denied') {/*
        Notification.requestPermission(function (permission) {
          // Whatever the user answers, we make sure we store the information
          if (!('permission' in Notification)) {
            Notification.permission = permission;
          }

          // If the user is okay, let's create a notification
          if (permission === "granted") {
            var options = {
            body: text,
            icon: "{% static 'teranga_food_logo_192.png' %}",
            dir : "ltr"
        };
            var notification = new Notification("Notification",options);
          }
        });
      */}

  // At last, if the user already denied any notification, and you
  // want to be respectful there is no need to bother them any more.
}



    </script>
 {% block bloc_script %}

        {% endblock %}
</body>

</html>